#!/bin/bash -e

# if [ "$1" != "no-docs" ]; then
#     rm -rf docs
#     cp -r docs~preserve docs
#     rm -rf docs~preserve
# fi

# Clean up test files created during tests
rm -f packages/docs/content/test-content.md
rm -f packages/docs/content/test-link.md
rm -f packages/docs/content/media/index.csv
rm -f packages/docs/content/media/logo-test.png

cd packages/skeleton

cp var/app.db~ var/app.db
rm var/app.db~

rm -rf media
if [ -e media~preserve ]; then
    # Use mv instead of cp+rm for better performance
    mv media~preserve media
fi

if [ -e '/tmp/com.github.pushword.pushword/tests/var/dev/cache~' ]; then
 # Use mv instead of cp+rm for better performance
 rm -rf '/tmp/com.github.pushword.pushword/tests/var/dev/cache'
 mv '/tmp/com.github.pushword.pushword/tests/var/dev/cache~' '/tmp/com.github.pushword.pushword/tests/var/dev/cache'
fi